\documentclass[a4paper,11pt]{article}
\usepackage{graphicx}
\usepackage{onecolpceurws}
\usepackage{url}
\usepackage{hyperref}
\usepackage{verbatim}

\title{The TTC 2014 Movie Database Case}

\author{
Tassilo Horn\\ University of Koblenz-Landau\\ Germany\\ horn@uni-koblenz.de
\and
Christian Krause\\ SAP Innovation Center\\ Germany\\ christian.krause01@sap.com
\and
Matthias Tichy\\ Chalmers $|$ University of Gothenburg, Sweden \\matthias.tichy@cse.gu.se
}
\newcommand{\p}[1]{\textsf{\small #1}}

\institution{}

\newcommand{\qr}[3]{\noindent{}Top-15 #2 for #3:{\scriptsize\verbatiminput{query-results/#1}}}

\begin{document}
\maketitle

\begin{abstract}
  Social networks and other web 2.0 platforms use huge amounts of data to offer
  new services to customers. Often this data can be expressed as huge graphs
  and thus could be seen as a potential new application field for model
  transformations. However, this application area requires that model
  transformation tools scale to models with millions of objects. This
  transformation case targets this application area by using the IMDb movie
  database as a model. The transformation deals with identifying all actor
  couples which perform together in a set of at least three movies.
  \end{abstract}
\vskip 32pt


\section{Introduction (MTT)}

The driving force behind social networks and other new web 2.0
offerings is often huge amount of data. Consequently, concepts like
MapReduce \cite{Dean08} and libraries like Hadoop \cite{Hadoop} and
Giraph \cite{Giraph} have been developed to efficiently process these
huge amount of data. However, model transformation approaches have so
far not adressed this field.

Automotive software is an already well-established application field
for model-driven software engineering and its models also approach
huge sizes. As a consequence from these two examples, model
transformation approaches must be scalable to models with million
objects to be applicable for these application areas.

We present in the following a case which uses the IMDb movie database
\cite{IMDBDATA} as a data source. The IMDb movie database contains information
about movies, actors performing in the movies, movie ratings, etc. The main
task is to develop a model transformation which identifies \emph{all} couples
of two actors who perform in at least three common movies and calculate the
average rating of those movies.\footnote{This task together with a solution in Henshin is also
described in \cite{KTG14}.} This core task is then generalized to cliques
of \(n\) actors.  Furthermore, some queries calculating top-15 lists of
couples and cliques are to be written.  Evaluation criteria are correctness and
performance.

In the following section, we describe the case in more detail
including the meta model as well as the different basic and extension
tasks. After that, Section \ref{sec-eval} presents the evaluation
criteria for submitted solutions to this case.


\section{Detailed Case Description (MTT)}\label{sec-case}

We use the IMDb data about movies, actors, actresses, and movie ratings for
this transformation case. The resulting metamodel is shown in
Figure~\ref{fig:metamodel}.  The names of actors and actresses are always
unique in the models.  In addition to the obvious classes, the metamodel
contains a common superclass for actors and actresses as well as classes for
groups of actors which play in common movies. The class \p{Group} contains the
attribute \p{avgRating} which stores the average rating of the common movies of
the group of actors. The metamodel distinguishes between groups of two persons
(a \p{Couple}) or a \p{Clique} of $n$ persons to support the different tasks in
this transformation case.

\begin{figure}[ht]
\centering
\includegraphics[width=0.6\textwidth]{movies}
\caption{A metamodel for the relevant aspects of the movie database}
\label{fig:metamodel}
\end{figure}

The EMF model as well as a parser for the
IMDb database files is available at \cite{IMDB2EMF}. The pre-parsed
IMDb models are available on request. The transformation case will use
synthetic data (as generated in Task~1) for the evaluation of
the correctness of the submitted transformations as well as real data
from IMDb for the performance evaluation.


\subsection{Task 1: Generating Test Data (CK)}
\label{sec:gen-test-data}

%% Notes from Tassilo:
%%
%% - The test data generation currently creates models contains only couples.
%% For the extension tasks it would be good if the rules also created cliques
%% of size 3, 4, and 5.  The real data does contain such cliques, but finding
%% those is extremely costly.  Therefore, we should be able to validate
%% solutions for the extension tasks also with just the simpler, smaller
%% generated models.
%%
%% - The test data generation should also assign unique names to the Actors and
%% Actresses, and ratings to the Movies.  Else, the computation of the average
%% rating and the top-15 queries cannot be evaluated with the test models.
%% (Again, the real IMDb models are probably to complex/large for most
%% participants.)

The goal of this task is to generate (synthetic) test data which will be used
later to evaluate the correctness and the performance of the solution of the 
main task. The transformation to be implemented takes an empty model and 
generates a number of movies, actresses, actors and references between them.
The number of objects to be generated is determined by an integer-valued 
runtime parameter $n\geq0$. Specifically, the transformation is supposed
to generate $5n$ actors, $5n$ actresses and $10n$ movies, totalling in 
$20n$ nodes. For every generated actor and actress a unique name, and for 
every movie a rating is derived from $n$. Additionally, the references between
persons and movies are generated in a specified way.

The specific patterns to be generated are shown in the Henshin~\cite{ABJ+10} rules in
Figure~\ref{fig:gen-test-data}. Each of the two used rules generates five
persons and five movies. The movie ratings and the name of the persons are
derived from $n$. The five persons in the rule \textsf{createPositive} play
together in three movies. In contrast,
every possible pair of persons generated by the rule \textsf{createNegative}
plays together in at most two movies.

For the following tasks, test data should be generated for different values 
of $n$ which can be found in Table~\ref{tab:synthetic-numbers}.


\begin{figure}[p]
\centering
\includegraphics[scale=1.0,angle=90]{gen-test-data3}
\caption{Henshin specification for generating synthetic movie test data.}
\label{fig:gen-test-data}
\end{figure}

\subsection{Task 2: Finding Couples (CK)}

In this task, a transformation shall be implemented that takes a graph
consisting of inter-connected movies, actors and actresses as input, and
creates additional nodes and links in this graph.\footnote{Both in-place and
  out-place transformation approaches are possible.} Specifically, the task is
to find all pairs of persons (actors or actresses) which played together in at
least three movies.  For every such pair, the transformation is supposed to
create an object of type \textsf{Couple} referencing both persons using the
\p{p1} and \p{p2} references, and referencing all movies in which
\emph{both} persons played in using the \p{commonMovies} reference.


\subsection{Task 3: Computing Average Rankings (CK)}

The input model of this task is the one generated in Task 2,
i.e., a graph consisting of movie, actor, actress and couple
nodes. The goal of this task is to set the \p{avgRating}-attribute
of all couple nodes to the average (i.e. the
arithmetic mean) of the ratings of all movies that
\emph{both} persons played in.

\subsection{Extension Task 1: Compute Top-15 Couples (TH)}

The goal of this task is to produce top-15 lists of the couples created by
Task~2.  For this purpose, two model queries should be given.

\begin{enumerate}
\item[(a)] Compute the top 15 couples according to the average rating of
  their common movies (requires Task~3 to be solved).
\item[(b)] Compute the top 15 couples according to the number of common movies.
\end{enumerate}

Each of the couples in the top-15 lists should be printed with the names of the
two persons, the average rating (only if Task~3 has been solved), and the
number of the couple's common movies.  We don't require printing the common
movies' titles because the couple with the most common movies in the complete
IMDb model has more than 400 of them.

If two couples have the same value for the average rating/number of common
movies, their order should be determined in some stable manner.

\subsection{Extension Task 2: Finding Cliques (TH)}

This extension task is a generalization of Task~2.  A clique is a group of at
least \(n\) persons (with \(n \geq 3\)) acting together in at least 3 movies.
So a couple is essentially a clique of size \(n = 2\).

The extension task is to find cliques of a given size \(n\), and to create a
\p{Clique} element for each of them referencing the clique's members, and
its common movies like the couples in Task~2.

The task will be evaluated for \(n \in \{3, 4, 5\}\), so it can be solved by
writing three similar rules manually.  However, to achieve a full completeness
score for this task, a solution should work for any \(n \geq 3\).  Therefore, a
transformation could have \(n\) as a parameter, or there could be a
higher-order transformation that receives \(n\) and generates a rule creating
cliques of exactly that size.

It would be interesting to be able to specify the required number of common
movies \(c\) freely.  By default and according to Task~2, \(c\) is fixed to 3.
You can earn an extra bonus point if \(c\) may be customized.


\subsection{Extension Task 3: Compute Average Rankings for Cliques (TH)}

Like it was done for couples in Task~3, the \p{avgRating} attribute of
cliques should be set to the average rating of all its common movies.

\subsection{Extension Task 4: Compute Top-15 Cliques (TH)}

This is a variant of Extension Task~1 for cliques instead of couples.  Again,
two queries should be given.

\begin{enumerate}
\item[(a)] Compute the top-15 cliques of a given size \(n\) according to the
  average rating of their common movies (requires Extension Task~3 to be
  solved).
\item[(b)] Compute the top-15 cliques of a given size \(n\) according to the
  number of common movies.
\end{enumerate}

Again, every clique should be printed with the names of its members, the
average rating, and the number of common movies.


\section{Evaluation Criteria (MTT)}\label{sec-eval}

The evaluation of the submitted transformation will be done on
synthetic data as well as real data from the IMDb database. The IMDb
database is regularly updated. In order to provide a common set of
data, we provide the IMDb database in a version from December 2013 to
participants by request. 

\subsection{Correctness Tests (TH)}

Correctness is checked using the synthetic data.

We provide: number of couples and top ten lists.

\subsection{Benchmarks (CK)}

The goal of this task is to generate a performance benchmark
of your solution to Task 2 (finding couples). This benchmark should be
executed using two different sets of input data:
\begin{enumerate}
\item[(a)] synthetic test data generated using the transformation for Task 1, 
\item[(b)] provided data from the IMDb movie database (available at \cite{IMDBDATA}; parsable, e.g., using \cite{IMDB2EMF}).
\end{enumerate}
For both cases, you should run the transformation for Task 2 
and measure the time needed to complete the transformation 
(without loading and saving the model).
If you solved also the extension task 2 (finding cliques), please also generate benchmarks
for this cases.

%% Tassilo: Why not measuring Task 2 on its own?

In order to evaluate the scalability of the solution and to compare it with other solutions,
you should use specific input models / model sizes. For the synthetic test data, please use
the values for $n$ shown in Table~\ref{tab:synthetic-numbers}. For the IMDB data version,
please use the provided models listed in Table~\ref{tab:imdb-numbers}.

%We recommend plotting the run-times using charts where
%the x-axis refers to the size of the input model in number of nodes,
%and the y-axis shows the execution times (e.g. in seconds).

\noindent
\textbf{Important:}
\begin{itemize}
\item Please restrict your benchmarks to those input models that can be
processed within \textbf{5 minutes} or less. Transformations that take longer than 5 minutes
will not be considered in the evaluation.
\item Please provide a solution that can run on an x86-based Linux system and that can be started
on the command-line. This will be important to reproduce your results, in particular the benchmarks.
Please document the setup of your solution and the requirements to the system environment.
\end{itemize}

\bibliographystyle{plain}
\bibliography{biblio}

\newpage
\appendix

\section{Expected Number of Couples and Cliques}
\label{sec:expected-numbers}

\begin{table}[!ht]
  \centering
  \begin{tabular}{| l | r | r | r | r |}
    \hline
    \textbf{Model (\(n\))} & \textbf{\#Couples} & \textbf{\#3-Cliques} & \textbf{\#4-Cliques} & \textbf{\#5-Cliques}\\
    \hline
    1000   & 10000   & 10000   & 5000    & 1000\\
    2000   & 20000   & 20000   & 10000   & 2000\\
    3000   & 30000   & 30000   & 15000   & 3000\\
    4000   & 40000   & 40000   & 20000   & 4000\\
    5000   & 50000   & 50000   & 25000   & 5000\\
    10000  & 100000  & 100000  & 50000   & 10000\\
    50000  & 500000  & 500000  & 250000  & 50000\\
    100000 & 1000000 & 1000000 & 500000  & 100000\\
    200000 & 2000000 & 2000000 & 1000000 & 200000\\
    \hline
\end{tabular}
\caption{The synthetic models with the expected numbers of Couples and Cliques of various sizes}
\label{tab:synthetic-numbers}
\end{table}


\begin{table}[!ht]
  \centering
  \begin{tabular}{| l | r | r |}
    \hline
    \textbf{Model}              & \textbf{\#Couples} & \textbf{\#3-Cliques}\\
    \hline
    imdb-0005000-49930.movies   & 17352              & 127825\\
    imdb-0010000-98168.movies   & 28211              & 188712\\
    imdb-0030000-207420.movies  & 35198              & 200532\\
    imdb-0045000-299504.movies  & 43294              & 210985\\
    imdb-0065000-404920.movies  & 57889              & 220891\\
    imdb-0085000-499995.movies  & 79470              & 243314\\
    imdb-0130000-709551.movies  & 136956             & 307405\\
    imdb-0200000-1004463.movies & 244627             & 457833\\
    imdb-0340000-1505143.movies & 585689             & 1469156\\
    imdb-0495000-2000900.movies & 1017752            & 2173809\\
    imdb-0660000-2501893.movies & 1562317            & 3953798\\
    imdb-all-3257145.movies     & 2709371            & 8227081\\
    \hline
  \end{tabular}
  \caption{The IMDb Models with the expected numbers of Couples and Cliques of size 3}
  \label{tab:imdb-numbers}
\end{table}

\newpage
\section{Expected Top-15 Lists}
\label{sec:top-15}

\subsection{Synthetic Models}
\label{sec:top-15:synthetic-models}

\subsubsection{Couples}

%% Couples
\qr{synth-1000.query.couples}{couples}{synthetic model with \(n=1000\)}
\qr{synth-2000.query.couples}{couples}{synthetic model with \(n=2000\)}
\qr{synth-3000.query.couples}{couples}{synthetic model with \(n=3000\)}
\qr{synth-4000.query.couples}{couples}{synthetic model with \(n=4000\)}
\qr{synth-5000.query.couples}{couples}{synthetic model with \(n=5000\)}
\qr{synth-10000.query.couples}{couples}{synthetic model with \(n=10000\)}
\qr{synth-50000.query.couples}{couples}{synthetic model with \(n=50000\)}
\qr{synth-100000.query.couples}{couples}{synthetic model with \(n=100000\)}
\qr{synth-200000.query.couples}{couples}{synthetic model with \(n=200000\)}

\newpage
\subsubsection{Cliques of size 3}

%% Cliques of size 3
\qr{synth-1000.query.3cliques}{3-cliques}{synthetic model with \(n=1000\)}
\qr{synth-2000.query.3cliques}{3-cliques}{synthetic model with \(n=2000\)}
\qr{synth-3000.query.3cliques}{3-cliques}{synthetic model with \(n=3000\)}
\qr{synth-4000.query.3cliques}{3-cliques}{synthetic model with \(n=4000\)}
\qr{synth-5000.query.3cliques}{3-cliques}{synthetic model with \(n=5000\)}
\qr{synth-10000.query.3cliques}{3-cliques}{synthetic model with \(n=10000\)}
\qr{synth-50000.query.3cliques}{3-cliques}{synthetic model with \(n=50000\)}
\qr{synth-100000.query.3cliques}{3-cliques}{synthetic model with \(n=100000\)}
\qr{synth-200000.query.3cliques}{3-cliques}{synthetic model with \(n=200000\)}

\newpage
\subsubsection{Cliques of size 4}

%% Cliques of size 4
\qr{synth-1000.query.4cliques}{4-cliques}{synthetic model with \(n=1000\)}
\qr{synth-2000.query.4cliques}{4-cliques}{synthetic model with \(n=2000\)}
\qr{synth-3000.query.4cliques}{4-cliques}{synthetic model with \(n=3000\)}
\qr{synth-4000.query.4cliques}{4-cliques}{synthetic model with \(n=4000\)}
\qr{synth-5000.query.4cliques}{4-cliques}{synthetic model with \(n=5000\)}
\qr{synth-10000.query.4cliques}{4-cliques}{synthetic model with \(n=10000\)}
\qr{synth-50000.query.4cliques}{4-cliques}{synthetic model with \(n=50000\)}
\qr{synth-100000.query.4cliques}{4-cliques}{synthetic model with \(n=100000\)}
\qr{synth-200000.query.4cliques}{4-cliques}{synthetic model with \(n=200000\)}

\newpage
\subsubsection{Cliques of size 5}

%% Cliques of size 5
\qr{synth-1000.query.5cliques}{5-cliques}{synthetic model with \(n=1000\)}
\qr{synth-2000.query.5cliques}{5-cliques}{synthetic model with \(n=2000\)}
\qr{synth-3000.query.5cliques}{5-cliques}{synthetic model with \(n=3000\)}
\qr{synth-4000.query.5cliques}{5-cliques}{synthetic model with \(n=4000\)}
\qr{synth-5000.query.5cliques}{5-cliques}{synthetic model with \(n=5000\)}
\qr{synth-10000.query.5cliques}{5-cliques}{synthetic model with \(n=10000\)}
\qr{synth-50000.query.5cliques}{5-cliques}{synthetic model with \(n=50000\)}
\qr{synth-100000.query.5cliques}{5-cliques}{synthetic model with \(n=100000\)}
\qr{synth-200000.query.5cliques}{5-cliques}{synthetic model with \(n=200000\)}

\newpage
\subsection{IMDb Models}
\label{sec:top-15:imdb-models}

\subsubsection{Couples}

%% Couples
\qr{imdb-0005000-49930.movies.bin.query.couples}{couples}{model \p{imdb-0005000-49930}}
\qr{imdb-0010000-98168.movies.bin.query.couples}{couples}{model \p{imdb-0010000-98168}}
\qr{imdb-0030000-207420.movies.bin.query.couples}{couples}{model \p{imdb-0030000-207420}}
\qr{imdb-0045000-299504.movies.bin.query.couples}{couples}{model \p{imdb-0045000-299504}}
\qr{imdb-0065000-404920.movies.bin.query.couples}{couples}{model \p{imdb-0065000-404920}}
\qr{imdb-0085000-499995.movies.bin.query.couples}{couples}{model \p{imdb-0085000-499995}}
\qr{imdb-0130000-709551.movies.bin.query.couples}{couples}{model \p{imdb-0130000-709551}}
\qr{imdb-0200000-1004463.movies.bin.query.couples}{couples}{model \p{imdb-0200000-1004463}}
\qr{imdb-0340000-1505143.movies.bin.query.couples}{couples}{model \p{imdb-0340000-1505143}}
\qr{imdb-0495000-2000900.movies.bin.query.couples}{couples}{model \p{imdb-0495000-2000900}}
\qr{imdb-0660000-2501893.movies.bin.query.couples}{couples}{model \p{imdb-0660000-2501893}}
\qr{imdb-all-3257145.movies.bin.query.couples}{couples}{model \p{imdb-all-3257145}}


\newpage
\subsubsection{Cliques of size 3}

%% Cliques of size 3
\qr{imdb-0005000-49930.movies.bin.query.triples}{3-cliques}{model \p{imdb-0005000-49930}}
\qr{imdb-0010000-98168.movies.bin.query.triples}{3-cliques}{model \p{imdb-0010000-98168}}
\qr{imdb-0030000-207420.movies.bin.query.triples}{3-cliques}{model \p{imdb-0030000-207420}}
\qr{imdb-0045000-299504.movies.bin.query.triples}{3-cliques}{model \p{imdb-0045000-299504}}
\qr{imdb-0065000-404920.movies.bin.query.triples}{3-cliques}{model \p{imdb-0065000-404920}}
\qr{imdb-0085000-499995.movies.bin.query.triples}{3-cliques}{model \p{imdb-0085000-499995}}
\qr{imdb-0130000-709551.movies.bin.query.triples}{3-cliques}{model \p{imdb-0130000-709551}}
\qr{imdb-0200000-1004463.movies.bin.query.triples}{3-cliques}{model \p{imdb-0200000-1004463}}
\qr{imdb-0340000-1505143.movies.bin.query.triples}{3-cliques}{model \p{imdb-0340000-1505143}}
\qr{imdb-0495000-2000900.movies.bin.query.triples}{3-cliques}{model \p{imdb-0495000-2000900}}
\qr{imdb-0660000-2501893.movies.bin.query.triples}{3-cliques}{model \p{imdb-0660000-2501893}}
\qr{imdb-all-3257145.movies.bin.query.triples}{3-cliques}{model \p{imdb-all-3257145}}


\end{document}


% Local Variables:
% coding: utf-8-dos
% End:
